<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Curso de Acuarela - Inicio</title>

  <!-- Bootstrap 5 -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <!-- Icons -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">
  <!-- Estilos propios -->
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <!-- Navbar -->
  <nav class="navbar navbar-expand-lg navbar-light bg-white bg-opacity-70 backdrop-blur border-bottom sticky-top">
    <div class="container">
      <a class="navbar-brand fw-bold d-flex align-items-center" href="index.html">
        <span class="brand-pill me-2"></span> Curso de Acuarela
      </a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navMain">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div id="navMain" class="collapse navbar-collapse">
        <ul class="navbar-nav ms-auto align-items-lg-center gap-lg-2">
          <li class="nav-item"><a class="nav-link active" href="index.html">Inicio</a></li>
          <li class="nav-item"><a class="nav-link" href="cursos.html">Comprar cursos</a></li>
          <li class="nav-item"><a class="nav-link" href="mis-cursos.html">Mis cursos</a></li>
          <li class="nav-item ms-lg-2">
            <button id="btnLogout" class="btn btn-outline-secondary btn-sm d-none" onclick="appLogout()">
              <i class="bi bi-box-arrow-right me-1"></i>Salir
            </button>
          </li>
        </ul>
      </div>
    </div>
  </nav>

  <!-- Hero -->
  <section class="py-5 bg-hero">
    <div class="container">
      <div class="row align-items-center g-4">
        <div class="col-lg-7">
          <h1 class="display-5 fw-extrabold text-gradient mb-3">Bienvenid@ al mundo de la acuarela</h1>
          <p class="lead text-secondary mb-4">
            Explora técnicas, practica con láminas y organiza tu aprendizaje. Tu progreso queda guardado con tu cuenta.
          </p>
          <ul class="list-unstyled small text-body">
            <li class="mb-1"><i class="bi bi-check2-circle text-primary me-2"></i>Lecciones con control de avance</li>
            <li class="mb-1"><i class="bi bi-check2-circle text-primary me-2"></i>Imágenes PNG descargables</li>
            <li class="mb-1"><i class="bi bi-check2-circle text-primary me-2"></i>Calendario de actividades</li>
          </ul>
        </div>
        <div class="col-lg-5">
          <!-- Tarjeta de Autenticación -->
          <div class="card shadow-lg border-0 rounded-4 glass-card">
            <div class="card-body p-4 p-md-5">
              <div class="mb-3">
                <h2 class="h4 fw-bold mb-1">Tu espacio creativo</h2>
                <p class="text-secondary small mb-0">Inicia sesión o crea tu cuenta</p>
              </div>

              <!-- Login -->
              <form id="loginForm" class="needs-validation" novalidate>
                <div class="row g-3">
                  <div class="col-12">
                    <label class="form-label">Correo</label>
                    <input type="email" name="email" class="form-control" placeholder="tu@correo.com" required>
                    <div class="invalid-feedback">Ingresa un correo válido.</div>
                  </div>
                  <div class="col-12">
                    <label class="form-label">Contraseña</label>
                    <input type="password" name="password" class="form-control" placeholder="Tu contraseña" required>
                    <div class="invalid-feedback">La contraseña es obligatoria.</div>
                  </div>
                  <div class="col-12 d-grid d-md-flex gap-2">
                    <button type="submit" class="btn btn-primary flex-grow-1">
                      <i class="bi bi-box-arrow-in-right me-1"></i> Entrar
                    </button>
                    <button type="button" class="btn btn-light border d-flex align-items-center justify-content-center gap-2 flex-grow-1" onclick="googleLogin()">
                      <img src="https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/google.svg" alt="" width="18" height="18">
                      Iniciar con Google
                    </button>
                  </div>
                </div>
              </form>

              <!-- Divider -->
              <div class="text-center my-3 position-relative">
                <hr>
                <span class="bg-white px-2 small text-muted position-absolute top-50 start-50 translate-middle">o</span>
              </div>

              <!-- Registro -->
              <form id="registerForm" class="needs-validation" novalidate>
                <div class="row g-3">
                  <div class="col-12">
                    <label class="form-label">Nombre de usuario (alias)</label>
                    <input type="text" name="displayName" class="form-control" placeholder="Tu nombre visible" required>
                    <div class="invalid-feedback">Ingresa un nombre visible.</div>
                  </div>
                  <div class="col-12">
                    <label class="form-label">Correo</label>
                    <input type="email" name="email" class="form-control" placeholder="tu@correo.com" required>
                    <div class="invalid-feedback">Ingresa un correo válido.</div>
                  </div>
                  <div class="col-12">
                    <label class="form-label">Contraseña</label>
                    <input type="password" name="password" class="form-control" placeholder="Mínimo 6 caracteres" minlength="6" required>
                    <div class="invalid-feedback">Mínimo 6 caracteres.</div>
                  </div>
                  <div class="col-12 d-grid">
                    <button type="submit" class="btn btn-outline-primary">
                      <i class="bi bi-person-plus me-1"></i> Registrarme
                    </button>
                  </div>
                </div>
              </form>

              <hr class="my-4">
              <div class="d-grid d-md-flex gap-2">
                <a href="cursos.html" class="btn btn-success flex-grow-1">
                  <i class="bi bi-bag-check me-1"></i> Comprar cursos
                </a>
                <a href="curso.html" class="btn btn-outline-secondary flex-grow-1">
                  <i class="bi bi-journal-bookmark me-1"></i> Mis cursos
                </a>
              </div>

            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <footer class="py-4">
    <div class="container small text-center text-secondary">
      © 2025 Acuarela
    </div>
  </footer>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

  <!-- Firebase SDKs -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.13.1/firebase-app.js";
    import {
      getAuth,
      GoogleAuthProvider,
      signInWithPopup,
      createUserWithEmailAndPassword,
      signInWithEmailAndPassword,
      updateProfile,
      signOut,
      onAuthStateChanged
    } from "https://www.gstatic.com/firebasejs/10.13.1/firebase-auth.js";

    // CONFIG REAL
 const firebaseConfig = {
  apiKey: "AIzaSyDz0gGjx6Rw01MJ-s4hZC5DwYuGymeOL44",
  authDomain: "acuarela-e4613.firebaseapp.com",
  projectId: "acuarela-e4613",
  storageBucket: "acuarela-e4613.firebasestorage.app",
  messagingSenderId: "319613648205",
  appId: "1:319613648205:web:f693e3f4e1b9abd4aa0b04",
  measurementId: "G-KMJW7RZRTT"
};
    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const provider = new GoogleAuthProvider();

    // Validación visual Bootstrap
    (() => {
      const forms = document.querySelectorAll('.needs-validation');
      Array.from(forms).forEach(form => {
        form.addEventListener('submit', event => {
          if (!form.checkValidity()) {
            event.preventDefault();
            event.stopPropagation();
          }
          form.classList.add('was-validated');
        }, false);
      });
    })();

    // Google
    window.googleLogin = async () => {
      try {
        await signInWithPopup(auth, provider);
        window.location.href = "cursos.html";
      } catch (e) {
        alert("No se pudo iniciar con Google: " + e.message);
        console.error(e);
      }
    };

    // Logout
    window.appLogout = async () => {
      await signOut(auth);
      window.location.href = "index.html";
    };

    // Formularios
    document.addEventListener("DOMContentLoaded", () => {
      const loginForm = document.getElementById("loginForm");
      const registerForm = document.getElementById("registerForm");

      if (loginForm) {
        loginForm.addEventListener("submit", async (e) => {
          e.preventDefault();
          if (!loginForm.checkValidity()) return;
          const email = loginForm.email.value.trim();
          const password = loginForm.password.value;
          try {
            await signInWithEmailAndPassword(auth, email, password);
            window.location.href = "cursos.html";
          } catch (err) {
            alert("Credenciales inválidas o usuario no registrado.");
            console.error(err);
          }
        });
      }

      if (registerForm) {
        registerForm.addEventListener("submit", async (e) => {
          e.preventDefault();
          if (!registerForm.checkValidity()) return;
          const displayName = registerForm.displayName.value.trim();
          const email = registerForm.email.value.trim();
          const password = registerForm.password.value;
          try {
            const cred = await createUserWithEmailAndPassword(auth, email, password);
            if (displayName) await updateProfile(cred.user, { displayName });
            alert("Cuenta creada. Ya puedes iniciar sesión.");
            registerForm.reset();
            registerForm.classList.remove('was-validated');
          } catch (err) {
            alert(err.message);
            console.error(err);
          }
        });
      }
    });

    // Estado de sesión -> botón Salir
    onAuthStateChanged(auth, (user) => {
      const btnLogout = document.getElementById("btnLogout");
      if (user) {
        localStorage.setItem("user", JSON.stringify({
          uid: user.uid, email: user.email, name: user.displayName || user.email
        }));
        btnLogout?.classList.remove("d-none");
      } else {
        localStorage.removeItem("user");
        btnLogout?.classList.add("d-none");
      }
    });
  </script>
</body>
</html>

