<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Curso de Acuarela - Inicio</title>
  <link rel="stylesheet" href="styles.css"/>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
</head>
<body>
  <!-- Navbar -->
  <header class="navbar">
    <div class="container nav__inner">
      <a class="brand" href="index.html">
        <span class="brand__dot"></span>
        Curso de Acuarela
      </a>
      <nav class="nav__links">
        <a href="index.html" class="active">Inicio</a>
        <a href="curso.html">Curso</a>
        <a href="imagenes.html">Imágenes</a>
        <a href="calendario.html">Calendario</a>
        <button id="btnLogout" class="btn btnLight btnSmall" style="display:none;" onclick="appLogout()">Salir</button>
      </nav>
    </div>
  </header>

  <!-- Landing -->
  <main class="landing">
    <!-- Hero -->
    <section class="hero card glass">
      <h1 class="hero__title">Bienvenid@ al mundo de la acuarela</h1>
      <p class="hero__subtitle">
        Explora técnicas, practica con láminas y organiza tu aprendizaje. Todo con un estilo artístico y tu progreso guardado.
      </p>
      <ul class="hero__bullets">
        <li>Lecciones con control de avance</li>
        <li>Imágenes PNG para descargar</li>
        <li>Calendario de actividades</li>
      </ul>
    </section>

    <!-- Auth -->
    <section class="auth card glass">
      <div class="auth__header">
        <h2>Tu espacio creativo</h2>
        <p>Inicia sesión o crea tu cuenta</p>
      </div>

      <div class="auth__grid">
        <!-- Login -->
        <form id="loginForm" class="form form--inline">
          <div class="form__row">
            <label>Correo</label>
            <input type="email" name="email" placeholder="tu@correo.com" required />
          </div>
          <div class="form__row">
            <label>Contraseña</label>
            <input type="password" name="password" placeholder="Tu contraseña" required />
          </div>
          <div class="form__actions">
            <button type="submit" class="btn btnPrimary">Entrar</button>
            <button type="button" class="btn btnGoogle" onclick="googleLogin()">
              <img src="https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/google.svg" alt="Google" />
              Iniciar con Google
            </button>
          </div>
        </form>

        <!-- Divider -->
        <div class="divider" role="separator" aria-label="o">
          <span>o</span>
        </div>

        <!-- Register -->
        <form id="registerForm" class="form">
          <div class="form__row">
            <label>Nombre de usuario (alias)</label>
            <input type="text" name="displayName" placeholder="Tu nombre visible" required />
          </div>
          <div class="form__row">
            <label>Correo</label>
            <input type="email" name="email" placeholder="tu@correo.com" required />
          </div>
          <div class="form__row">
            <label>Contraseña</label>
            <input type="password" name="password" placeholder="Mínimo 6 caracteres" required />
          </div>
          <div class="form__actions">
            <button type="submit" class="btn btnLight">Registrarme</button>
          </div>
        </form>
      </div>
    </section>
  </main>

  <footer class="footer">
    <div class="container">© 2025 Acuarela</div>
  </footer>

  <!-- Firebase SDKs (v9+ modular) -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.13.1/firebase-app.js";
    import {
      getAuth,
      GoogleAuthProvider,
      signInWithPopup,
      createUserWithEmailAndPassword,
      signInWithEmailAndPassword,
      updateProfile,
      signOut,
      onAuthStateChanged
    } from "https://www.gstatic.com/firebasejs/10.13.1/firebase-auth.js";

    // Pega aquí tu configuración real de Firebase
   const firebaseConfig = {
  apiKey: "AIzaSyDz0gGjx6Rw01MJ-s4hZC5DwYuGymeOL44",
  authDomain: "acuarela-e4613.firebaseapp.com",
  projectId: "acuarela-e4613",
  storageBucket: "acuarela-e4613.firebasestorage.app",
  messagingSenderId: "319613648205",
  appId: "1:319613648205:web:f693e3f4e1b9abd4aa0b04",
  measurementId: "G-KMJW7RZRTT"
};

    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const provider = new GoogleAuthProvider();

    // Botón Google
    window.googleLogin = async () => {
      try {
        await signInWithPopup(auth, provider);
        window.location.href = "curso.html";
      } catch (e) {
        alert("No se pudo iniciar con Google: " + e.message);
        console.error(e);
      }
    };

    // Salir
    window.appLogout = async () => {
      await signOut(auth);
      window.location.href = "index.html";
    };

    // Formularios
    document.addEventListener("DOMContentLoaded", () => {
      const loginForm = document.getElementById("loginForm");
      const registerForm = document.getElementById("registerForm");

      if (loginForm) {
        loginForm.addEventListener("submit", async (e) => {
          e.preventDefault();
          const email = loginForm.email.value.trim();
          const password = loginForm.password.value;
          try {
            await signInWithEmailAndPassword(auth, email, password);
            window.location.href = "curso.html";
          } catch (err) {
            alert("Credenciales inválidas o usuario no registrado.");
            console.error(err);
          }
        });
      }

      if (registerForm) {
        registerForm.addEventListener("submit", async (e) => {
          e.preventDefault();
          const displayName = registerForm.displayName.value.trim();
          const email = registerForm.email.value.trim();
          const password = registerForm.password.value;
          if (password.length < 6) {
            alert("La contraseña debe tener al menos 6 caracteres.");
            return;
          }
          try {
            const cred = await createUserWithEmailAndPassword(auth, email, password);
            if (displayName) {
              await updateProfile(cred.user, { displayName });
            }
            alert("Cuenta creada. Ya puedes iniciar sesión.");
            registerForm.reset();
          } catch (err) {
            alert(err.message);
            console.error(err);
          }
        });
      }
    });

    // Estado de sesión -> muestra botón Salir y guarda datos mínimos
    onAuthStateChanged(auth, (user) => {
      const btnLogout = document.getElementById("btnLogout");
      if (user) {
        localStorage.setItem("user", JSON.stringify({
          uid: user.uid,
          email: user.email,
          name: user.displayName || user.email
        }));
        if (btnLogout) btnLogout.style.display = "inline-flex";
      } else {
        localStorage.removeItem("user");
        if (btnLogout) btnLogout.style.display = "none";
      }
    });
  </script>
</body>
</html>
